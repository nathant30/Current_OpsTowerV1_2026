# =============================================================================
# XPRESS OPS TOWER - COMPLETE ENVIRONMENT CONFIGURATION TEMPLATE
# Production-Ready Environment Variables Documentation
# Generated: February 8, 2026
# Version: 1.0.0
# =============================================================================
#
# SECURITY WARNING:
# - Never commit files with real values to version control
# - Use AWS Secrets Manager or HashiCorp Vault in production
# - Rotate all secrets every 90 days
# - All CHANGE_ME values MUST be replaced before deployment
#
# =============================================================================

# =============================================================================
# 1. APPLICATION CONFIGURATION
# =============================================================================

# Node Environment (Required)
# Options: development, production, test
NODE_ENV=production

# Server Configuration
PORT=3000
HOSTNAME=localhost
DEPLOYMENT_ID=opstower-v1-2026

# CORS Configuration (Required)
# Comma-separated list of allowed origins
CORS_ORIGIN=https://opstower.company.com,https://admin.company.com
CORS_ALLOWED_ORIGINS=${CORS_ORIGIN}

# Application URLs
NEXT_PUBLIC_API_URL=https://api.opstower.company.com
NEXT_PUBLIC_API_BASE_URL=${NEXT_PUBLIC_API_URL}
NEXT_PUBLIC_APP_URL=https://opstower.company.com
NEXT_PUBLIC_WEBSOCKET_URL=wss://ws.opstower.company.com
NEXT_PUBLIC_WS_URL=${NEXT_PUBLIC_WEBSOCKET_URL}

# =============================================================================
# 2. AUTHENTICATION & SECURITY (CRITICAL - ALL REQUIRED)
# =============================================================================

# JWT Secrets (CRITICAL - Generate with: openssl rand -hex 32)
# Must be exactly 64 hexadecimal characters (32 bytes)
JWT_SECRET=CHANGE_ME_run_openssl_rand_hex_32_MUST_BE_64_HEX_CHARS
JWT_ACCESS_SECRET=CHANGE_ME_run_openssl_rand_hex_32_MUST_BE_64_HEX_CHARS
JWT_REFRESH_SECRET=CHANGE_ME_run_openssl_rand_hex_32_MUST_BE_64_HEX_CHARS

# JWT Token Expiration
# Access tokens: Short-lived (1 hour)
# Refresh tokens: Long-lived (7 days)
JWT_ACCESS_EXPIRY=1h
JWT_REFRESH_EXPIRY=7d
JWT_EXPIRES_IN=24h

# Session Management
SESSION_EXTENSION_MINUTES=30
SESSION_TIMEOUT_MINUTES=480

# MFA Configuration (Required if MFA enabled)
MFA_SECRET_KEY=CHANGE_ME_run_openssl_rand_hex_32
MFA_ENABLED=true
MFA_BACKUP_CODES_COUNT=8
MFA_RATE_LIMIT_ATTEMPTS=5
MFA_RATE_LIMIT_WINDOW_MINUTES=15

# Database Field-Level Encryption (CRITICAL - Generate with: openssl rand -hex 32)
# Used for encrypting PII: SSN, drivers license, credit cards
# Must be exactly 64 hexadecimal characters (32 bytes)
DATABASE_ENCRYPTION_KEY=CHANGE_ME_run_openssl_rand_hex_32_MUST_BE_64_HEX_CHARS
# DATABASE_ENCRYPTION_KEY_V2=  # For key rotation (optional)

# VAPID Keys for Push Notifications (CRITICAL)
# Generate with: npx web-push generate-vapid-keys
NEXT_PUBLIC_VAPID_PUBLIC_KEY=CHANGE_ME_run_npx_web_push_generate_vapid_keys_PUBLIC
VAPID_PRIVATE_KEY=CHANGE_ME_run_npx_web_push_generate_vapid_keys_PRIVATE

# Cron Job Authentication (Required)
# Used to authenticate scheduled tasks
CRON_SECRET=CHANGE_ME_run_openssl_rand_hex_32
NEXT_PUBLIC_CRON_SECRET=${CRON_SECRET}

# Security Configuration
SECURITY_LOG_LEVEL=info
SECURITY_HEADERS_ENABLED=true
SECURITY_ALERT_EMAIL=security@company.com

# =============================================================================
# 3. DATABASE CONFIGURATION (CRITICAL)
# =============================================================================

# Primary Database Connection String (Required)
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://opstower_user:CHANGE_ME_secure_password@localhost:5432/xpress_ops_tower

# Individual Database Components (Required)
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=xpress_ops_tower
DATABASE_USER=opstower_user
DATABASE_PASSWORD=CHANGE_ME_secure_password_min_16_chars
DATABASE_SSL=true
DATABASE_TYPE=postgresql

# Database Connection Pool Configuration
DATABASE_MAX_CONNECTIONS=20
DATABASE_CONNECT_TIMEOUT=10000
DATABASE_IDLE_TIMEOUT=30000
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_ACQUIRE_TIMEOUT=60000
DB_REAP_INTERVAL=1000

# Read Replicas (Optional - for high availability)
# Comma-separated list of replica hosts
# READ_REPLICA_HOSTS=replica1.company.com:5432,replica2.company.com:5432

# Database Performance Tuning
SLOW_QUERY_THRESHOLD=1000

# PostgreSQL Metrics (for Grafana monitoring)
POSTGRES_METRICS_USER=metrics_user
POSTGRES_METRICS_PASSWORD=CHANGE_ME_metrics_password

# PostgreSQL Environment Variables (for Docker)
POSTGRES_DB=${DATABASE_NAME}
POSTGRES_USER=${DATABASE_USER}
POSTGRES_PASSWORD=${DATABASE_PASSWORD}

# Alternative Database Options (if not using PostgreSQL)
# SQLITE_DATABASE=opstower.db
# SQLITE_PATH=/data/opstower.db

# =============================================================================
# 4. REDIS CONFIGURATION (CRITICAL)
# =============================================================================

# Redis Connection String (Required)
# Format: redis://[password@]host:port[/db]
REDIS_URL=redis://:CHANGE_ME_redis_password@localhost:6379/0

# Individual Redis Components
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_redis_password_min_16_chars
REDIS_DB=0

# Redis Cluster Mode (Optional - for high availability)
REDIS_CLUSTER=false
# Cluster nodes (required if REDIS_CLUSTER=true)
# REDIS_NODE_1_HOST=redis-node-1.company.com
# REDIS_NODE_1_PORT=6379
# REDIS_NODE_2_HOST=redis-node-2.company.com
# REDIS_NODE_2_PORT=6379
# REDIS_NODE_3_HOST=redis-node-3.company.com
# REDIS_NODE_3_PORT=6379

# =============================================================================
# 5. PAYMENT GATEWAYS (CRITICAL for Philippines Market)
# =============================================================================

# GCash via EBANX Integration (Required for GCash payments)
# Register at: https://www.ebanx.com
EBANX_API_KEY=CHANGE_ME_ebanx_integration_key
EBANX_API_SECRET=CHANGE_ME_ebanx_api_secret
EBANX_WEBHOOK_SECRET=CHANGE_ME_ebanx_webhook_secret_for_signature_verification
EBANX_BASE_URL=https://api.ebanx.com/ws/direct
EBANX_SANDBOX_BASE_URL=https://sandbox.ebanx.com/ws/direct
EBANX_SANDBOX_MODE=false
EBANX_PAYMENT_TIMEOUT_MINUTES=30

# Legacy GCash Variables (for backward compatibility)
GCASH_PROVIDER=ebanx
GCASH_API_KEY=${EBANX_API_KEY}
GCASH_API_SECRET=${EBANX_API_SECRET}
GCASH_MERCHANT_ID=CHANGE_ME_merchant_id
GCASH_WEBHOOK_SECRET=${EBANX_WEBHOOK_SECRET}
GCASH_INTEGRATION_KEY=${EBANX_API_KEY}
GCASH_BASE_URL=${EBANX_BASE_URL}
GCASH_SANDBOX_BASE_URL=${EBANX_SANDBOX_BASE_URL}
GCASH_SANDBOX_MODE=${EBANX_SANDBOX_MODE}
GCASH_PAYMENT_TIMEOUT_MINUTES=${EBANX_PAYMENT_TIMEOUT_MINUTES}
GCASH_WEBHOOK_URL=https://opstower.com/api/payments/gcash/webhook

# Maya (formerly PayMaya) Integration (Required for Maya payments)
# Register at: https://www.paymaya.com
MAYA_PUBLIC_KEY=CHANGE_ME_maya_public_key_from_dashboard
MAYA_SECRET_KEY=CHANGE_ME_maya_secret_key_from_dashboard
MAYA_WEBHOOK_SECRET=CHANGE_ME_maya_webhook_secret_for_signature_verification
MAYA_BASE_URL=https://pg.paymaya.com
MAYA_SANDBOX_MODE=false

# PayMaya Aliases (for backward compatibility)
PAYMAYA_PUBLIC_KEY=${MAYA_PUBLIC_KEY}
PAYMAYA_SECRET_KEY=${MAYA_SECRET_KEY}
PAYMAYA_MERCHANT_ID=CHANGE_ME_merchant_id
PAYMAYA_WEBHOOK_SECRET=${MAYA_WEBHOOK_SECRET}

# =============================================================================
# 6. COMMUNICATION SERVICES (CRITICAL)
# =============================================================================

# Twilio SMS Service (Required for SMS notifications)
# Register at: https://www.twilio.com
# Philippines SMS format: +639XXXXXXXXX
TWILIO_ACCOUNT_SID=CHANGE_ME_twilio_account_sid_from_console
TWILIO_AUTH_TOKEN=CHANGE_ME_twilio_auth_token_from_console
TWILIO_FROM_NUMBER=+639XXXXXXXXX
TWILIO_PHONE_NUMBER=${TWILIO_FROM_NUMBER}

# SendGrid Email Service (Required for email notifications)
# Register at: https://sendgrid.com
SENDGRID_API_KEY=CHANGE_ME_sendgrid_api_key_from_dashboard
SENDGRID_FROM_EMAIL=noreply@opstower.company.com
SENDGRID_BACKUP_API_KEY=CHANGE_ME_backup_sendgrid_key_for_failover

# Alternative SMS Provider (Optional)
SMS_API_KEY=CHANGE_ME_alternative_sms_provider_key
SMS_API_TOKEN=CHANGE_ME_alternative_sms_provider_token
SMS_FROM_NUMBER=+639XXXXXXXXX

# AWS SES Email (Optional - alternative to SendGrid)
AWS_SES_API_KEY=CHANGE_ME_aws_ses_access_key

# Generic Email Configuration
FROM_EMAIL=noreply@opstower.company.com

# SMTP Configuration (Optional - for self-hosted email)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=smtp_user
SMTP_PASS=CHANGE_ME_smtp_password
SMTP_USERNAME=${SMTP_USER}
SMTP_PASSWORD=${SMTP_PASS}

# =============================================================================
# 7. MONITORING & ALERTING (CRITICAL for Production)
# =============================================================================

# Prometheus & Grafana Monitoring
PROMETHEUS_ENABLED=true
GRAFANA_DASHBOARD_ENABLED=true
GRAFANA_ADMIN_PASSWORD=CHANGE_ME_run_openssl_rand_base64_24

# Slack Integration (Recommended for team alerts)
# Create webhook at: https://api.slack.com/messaging/webhooks
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_WEBHOOK_TOKEN=CHANGE_ME_slack_signing_secret
SLACK_DEFAULT_CHANNEL=#opstower-alerts

# PagerDuty Integration (Recommended for on-call)
# Register at: https://www.pagerduty.com
PAGERDUTY_SERVICE_KEY=CHANGE_ME_pagerduty_integration_key

# Custom Monitoring Webhooks (Optional)
MONITORING_WEBHOOK_URL=https://monitoring.company.com/webhook
ALERT_WEBHOOK_URL=https://alerts.company.com/webhook

# =============================================================================
# 8. AWS SERVICES (CRITICAL for Backups & Storage)
# =============================================================================

# AWS Credentials (Required for S3 backups)
# Create IAM user with S3 permissions
AWS_ACCESS_KEY_ID=CHANGE_ME_aws_access_key_id_20_chars
AWS_SECRET_ACCESS_KEY=CHANGE_ME_aws_secret_access_key_40_chars
AWS_REGION=ap-southeast-1

# S3 Backup Configuration (Required)
BACKUP_S3_BUCKET=opstower-backups-production
BACKUP_DIR=/var/backups/opstower
BACKUP_RETENTION_DAYS=30

# =============================================================================
# 9. GOOGLE SERVICES (REQUIRED for Maps)
# =============================================================================

# Google Maps API Key (Required for location tracking)
# Create at: https://console.cloud.google.com/google/maps-apis
# Enable: Maps JavaScript API, Geocoding API, Directions API
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=CHANGE_ME_google_maps_api_key_from_console

# =============================================================================
# 10. EMERGENCY CONFIGURATION (CRITICAL for Disaster Recovery)
# =============================================================================

# Emergency Contact Numbers (Required - comma-separated)
# Philippines format: +639XXXXXXXXX
EMERGENCY_SMS_NUMBERS=+639XXXXXXXXX,+639YYYYYYYYY,+639ZZZZZZZZZ
EMERGENCY_EMAIL_LIST=emergency@company.com,oncall@company.com,cto@company.com
EMERGENCY_CONTACTS=${EMERGENCY_SMS_NUMBERS}

# Emergency Mode Configuration
EMERGENCY_MODE=false
EMERGENCY_API_KEY=CHANGE_ME_emergency_api_key_long_random_string_min_32_chars
EMERGENCY_TEST_CONTACT=+639TESTPHONE

# Emergency Services (use same credentials as production)
TWILIO_EMERGENCY_SID=${TWILIO_ACCOUNT_SID}
TWILIO_EMERGENCY_TOKEN=${TWILIO_AUTH_TOKEN}
SENDGRID_EMERGENCY_API_KEY=${SENDGRID_API_KEY}

# Emergency Database & Cache (Optional - for disaster recovery)
# EMERGENCY_DATABASE_URL=postgresql://emergency:CHANGE_ME@emergency-db:5432/emergency
# EMERGENCY_REDIS_URL=redis://:CHANGE_ME@emergency-redis:6379/0
# EMERGENCY_DB_PASSWORD=CHANGE_ME_emergency_db_password

# Emergency Authentication (SECURITY WARNING: Should NEVER be used)
# EMERGENCY_AUTH_BYPASS=false  # ← NEVER SET TO TRUE IN PRODUCTION

# =============================================================================
# 11. RBAC & COMPLIANCE (Production Configuration)
# =============================================================================

# Role-Based Access Control (RBAC)
RBAC_ENABLED=true
RBAC_APPROVAL_TTL_HOURS=4
RBAC_ENABLE_MONITORING=true
RBAC_AUDIT_ENABLED=true
RBAC_MAX_VERSIONS_PER_ROLE=25
RBAC_CACHE_TTL_MINUTES=5

# =============================================================================
# 12. PERFORMANCE CONFIGURATION (Optional Tuning)
# =============================================================================

# API Rate Limiting
API_RATE_LIMIT_PER_MINUTE=1000
EXPORT_MAX_ROLES_PER_REQUEST=1000

# Session Configuration
SESSION_TIMEOUT_MINUTES=480

# Auto-start Services (development only - set to false in production)
AUTO_START_MONITOR=false
AUTO_START_METRICS=false
AUTO_START_SCHEDULER=false

# =============================================================================
# 13. FEATURE FLAGS (Optional - Default: true)
# =============================================================================

# Core Features
NEXT_PUBLIC_FEATURE_COMMAND_CENTER=true
NEXT_PUBLIC_FEATURE_GROUND_OPS=true
NEXT_PUBLIC_FEATURE_INCIDENTS=true
NEXT_PUBLIC_FEATURE_SHIFTS=true

# Additional Features
NEXT_PUBLIC_FEATURE_BONDS=true
NEXT_PUBLIC_FEATURE_CUSTOMER_PROMOS=true
NEXT_PUBLIC_FEATURE_DASHCAM=true
NEXT_PUBLIC_FEATURE_DRIVER_INCENTIVES=true
NEXT_PUBLIC_FEATURE_TRUST_SCORE=true
NEXT_PUBLIC_FEATURE_IDENTITY_VERIFICATION=true

# =============================================================================
# 14. DEVELOPMENT & TESTING (NEVER USE IN PRODUCTION)
# =============================================================================

# Development Mode Flags (DANGER: Remove in production)
# BYPASS_AUTH=false  # ← NEVER SET TO TRUE IN PRODUCTION
# USE_MOCK_DB=false  # ← NEVER SET TO TRUE IN PRODUCTION

# Test User Credentials (for testing only)
# TEST_USER_EMAIL=test@opstower.local
# TEST_USER_PASSWORD=Test123!@#SecurePassword

# =============================================================================
# SECURITY CHECKLIST BEFORE DEPLOYMENT
# =============================================================================
#
# Required Actions:
# ⚠️  [ ] Replace ALL CHANGE_ME values with real credentials
# ⚠️  [ ] All secrets must be at least 32 characters (64 for hex keys)
# ⚠️  [ ] Never commit this file with real values to version control
# ⚠️  [ ] Use AWS Secrets Manager or HashiCorp Vault in production
# ⚠️  [ ] Rotate all secrets every 90 days
# ⚠️  [ ] Never use BYPASS_AUTH or EMERGENCY_AUTH_BYPASS in production
# ⚠️  [ ] Enable MFA for all admin accounts
# ⚠️  [ ] Use strong, unique passwords (minimum 16 characters)
# ⚠️  [ ] Enable SSL/TLS for all database connections (DATABASE_SSL=true)
# ⚠️  [ ] Use Redis password authentication in production
# ⚠️  [ ] Configure proper CORS origins (no wildcards like *)
# ⚠️  [ ] Set up monitoring and alerting before deployment
# ⚠️  [ ] Test backup and restore procedures
# ⚠️  [ ] Configure emergency contacts
# ⚠️  [ ] Enable RBAC audit logging
# ⚠️  [ ] Set up security alert email notifications
#
# Philippine Compliance:
# ⚠️  [ ] BSP: Key rotation policy documented
# ⚠️  [ ] DPA: Data retention policy implemented
# ⚠️  [ ] PCI-DSS: Key management system configured
# ⚠️  [ ] LTFRB: Audit logging enabled
#
# =============================================================================

# =============================================================================
# QUICK START COMMANDS
# =============================================================================
#
# 1. Generate JWT secrets (32 bytes = 64 hex chars):
#    openssl rand -hex 32
#
# 2. Generate database encryption key (32 bytes = 64 hex chars):
#    openssl rand -hex 32
#
# 3. Generate VAPID keys for push notifications:
#    npx web-push generate-vapid-keys
#
# 4. Generate strong password (24 characters):
#    openssl rand -base64 24
#
# 5. Generate UUID (for deployment ID):
#    uuidgen
#
# 6. Test configuration (after setup):
#    npm run validate-env
#
# 7. Start development server:
#    cp .env.example .env.local
#    # Edit .env.local with your values
#    npm run dev
#
# 8. Build for production:
#    npm run build
#
# 9. Start production server:
#    npm run start
#
# =============================================================================

# =============================================================================
# SECRETS MANAGEMENT BEST PRACTICES
# =============================================================================
#
# 1. Local Development:
#    - Copy this file to .env.local
#    - .env.local is in .gitignore (never committed)
#    - Use development values only
#
# 2. Staging/Production:
#    - Use AWS Secrets Manager (recommended)
#    - Alternative: HashiCorp Vault
#    - Never use .env files in production
#
# 3. CI/CD (GitHub Actions):
#    - Store secrets in GitHub Secrets
#    - Access via: ${{ secrets.SECRET_NAME }}
#    - Never echo secrets in logs
#
# 4. Docker Deployments:
#    - Use Docker secrets or environment variables
#    - Mount secrets as files (more secure than ENV)
#    - Use BuildKit secret mounts for build-time secrets
#
# 5. Secret Rotation:
#    - JWT secrets: Every 90 days
#    - Database passwords: Every 90 days
#    - API keys: Every 180 days or on compromise
#    - Encryption keys: Use key versioning (DATABASE_ENCRYPTION_KEY_V2)
#
# 6. Emergency Procedures:
#    - Document break-glass access procedures
#    - Store emergency credentials offline (printed, secure)
#    - Test disaster recovery quarterly
#
# =============================================================================

# =============================================================================
# ENVIRONMENT VARIABLE PRIORITY
# =============================================================================
#
# Next.js loads environment variables in this order:
# 1. .env.local (loaded in all environments except test)
# 2. .env.[NODE_ENV].local (e.g., .env.production.local)
# 3. .env.[NODE_ENV] (e.g., .env.production)
# 4. .env
#
# Public variables (NEXT_PUBLIC_*):
# - Exposed to the browser
# - Embedded at build time
# - Use only for non-sensitive data
#
# Private variables:
# - Only available server-side
# - Never exposed to browser
# - Use for all secrets
#
# =============================================================================

# =============================================================================
# TROUBLESHOOTING
# =============================================================================
#
# Issue: Environment variables not loading
# Solution:
#   - Restart Next.js dev server after changing .env files
#   - Check variable names (case-sensitive)
#   - Ensure no spaces around = sign
#   - For NEXT_PUBLIC_* vars, rebuild the app
#
# Issue: Database connection fails
# Solution:
#   - Check DATABASE_URL format
#   - Verify host is reachable
#   - Test credentials manually: psql $DATABASE_URL
#   - Check firewall rules
#
# Issue: Redis connection fails
# Solution:
#   - Check REDIS_URL format
#   - Verify Redis is running: redis-cli ping
#   - Check password if set
#   - Verify network connectivity
#
# Issue: Payment gateway errors
# Solution:
#   - Verify API keys are correct
#   - Check sandbox mode setting
#   - Verify webhook secrets
#   - Check API rate limits
#
# =============================================================================

# =============================================================================
# SUPPORT & DOCUMENTATION
# =============================================================================
#
# Documentation:
#   - Secrets Management: docs/SECRETS_MANAGEMENT.md
#   - Database Encryption: docs/DATABASE_ENCRYPTION.md
#   - Deployment Guide: DEPLOYMENT.md
#   - Security Audit: SECRETS_AUDIT_REPORT.md
#
# Security Issues:
#   - Email: security@opstower.company.com
#   - Emergency: +639XXXXXXXXX
#
# Technical Support:
#   - Email: support@opstower.company.com
#   - Slack: #opstower-support
#
# =============================================================================

# END OF CONFIGURATION
