# =============================================================================
# OpsTower V1 2026 - Environment Configuration
# =============================================================================
#
# SECURITY NOTICE:
# - Copy this file to .env.local for development
# - NEVER commit .env.local or any file containing actual secrets
# - Use your deployment platform's environment variable manager for production
# - Railway: https://railway.app/project/{project-id}/settings
# - Vercel: https://vercel.com/{team}/{project}/settings/environment-variables
#
# =============================================================================

# =============================================================================
# APPLICATION
# =============================================================================
NODE_ENV=development
PORT=4000
HOSTNAME=localhost
CORS_ORIGIN=http://localhost:4000
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:4000

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================
# JWT Secrets - MUST be strong random strings in production
# Generate with: openssl rand -hex 32
JWT_SECRET=CHANGE_ME_use_openssl_rand_hex_32
JWT_ACCESS_SECRET=CHANGE_ME_use_openssl_rand_hex_32
JWT_REFRESH_SECRET=CHANGE_ME_use_openssl_rand_hex_32
JWT_ACCESS_EXPIRY=1h
JWT_REFRESH_EXPIRY=7d
JWT_EXPIRES_IN=24h

# Bypass authentication in development (NEVER use in production)
BYPASS_AUTH=false

# =============================================================================
# DATABASE ENCRYPTION
# =============================================================================
# Field-level encryption for sensitive database data
# Generate with: openssl rand -hex 32
# CRITICAL: Store securely in production (Railway Secrets, Vercel Environment Variables, AWS Secrets Manager)
DATABASE_ENCRYPTION_KEY=CHANGE_ME_use_openssl_rand_hex_32_for_32_byte_key
# Optional: For key rotation (generate new key, re-encrypt data, then remove old key)
# DATABASE_ENCRYPTION_KEY_V2=CHANGE_ME_use_openssl_rand_hex_32_for_rotation

# =============================================================================
# DATABASE - PostgreSQL
# =============================================================================
DATABASE_URL=postgresql://postgres:CHANGE_ME_DB_PASSWORD@localhost:5432/xpress_ops_tower
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=xpress_ops_tower
DATABASE_USER=postgres
DATABASE_PASSWORD=CHANGE_ME_DB_PASSWORD
DATABASE_SSL=true
DATABASE_TYPE=postgresql

# Database Connection Pool
DB_POOL_MIN=5
DB_POOL_MAX=50
DATABASE_MAX_CONNECTIONS=20
DATABASE_IDLE_TIMEOUT=30000
DATABASE_CONNECT_TIMEOUT=2000

# Database SSL Certificates (for production)
DATABASE_SSL_CERT=/path/to/database/ssl/client.crt
DATABASE_SSL_KEY=/path/to/database/ssl/client.key
DATABASE_SSL_CA=/path/to/database/ssl/ca.crt

# Database User Separation (production security best practice)
DATABASE_READER_URL=postgresql://xpress_reader:CHANGE_ME_READER_PASSWORD@localhost:5432/xpress_ops_tower?sslmode=require
DATABASE_WRITER_URL=postgresql://xpress_writer:CHANGE_ME_WRITER_PASSWORD@localhost:5432/xpress_ops_tower?sslmode=require
DATABASE_ADMIN_URL=postgresql://xpress_admin:CHANGE_ME_ADMIN_PASSWORD@localhost:5432/xpress_ops_tower?sslmode=require

# Database Encryption
# Generate with: openssl rand -hex 32
DATABASE_ENCRYPTION_KEY=CHANGE_ME_use_openssl_rand_hex_32
DATABASE_HASH_SALT=CHANGE_ME_use_random_salt

# Use mock database in development
USE_MOCK_DB=false

# =============================================================================
# REDIS - Cache & Session Store
# =============================================================================
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD
REDIS_DB=0

# Redis Cluster Nodes (for production high availability)
REDIS_NODE_1_HOST=redis-node-1
REDIS_NODE_1_PORT=6379
REDIS_NODE_2_HOST=redis-node-2
REDIS_NODE_2_PORT=6379
REDIS_NODE_3_HOST=redis-node-3
REDIS_NODE_3_PORT=6379

# =============================================================================
# GOOGLE MAPS API
# =============================================================================
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=CHANGE_ME_google_maps_api_key

# =============================================================================
# WEBSOCKET CONFIGURATION
# =============================================================================
NEXT_PUBLIC_WEBSOCKET_URL=ws://localhost:4000
NEXT_PUBLIC_WS_URL=ws://localhost:4000
WEBSOCKET_PORT=4000

# =============================================================================
# API CONFIGURATION
# =============================================================================
NEXT_PUBLIC_API_BASE_URL=/api
NEXT_PUBLIC_API_URL=http://localhost:5000

# =============================================================================
# EMAIL SERVICES
# =============================================================================
# Primary Email Provider: SendGrid
EMAIL_SERVICE_PROVIDER=sendgrid
SENDGRID_API_KEY=CHANGE_ME_sendgrid_api_key
FROM_EMAIL=noreply@opstower.com

# Backup Email Provider
SENDGRID_BACKUP_API_KEY=CHANGE_ME_backup_sendgrid_key

# AWS SES (Alternative)
AWS_SES_API_KEY=CHANGE_ME_aws_ses_key

# SMTP Configuration (Generic)
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=CHANGE_ME_smtp_username
SMTP_PASS=CHANGE_ME_smtp_password
SMTP_USERNAME=CHANGE_ME_smtp_username
SMTP_PASSWORD=CHANGE_ME_smtp_password

# =============================================================================
# SMS SERVICES
# =============================================================================
# Primary SMS Provider: Twilio
SMS_SERVICE_PROVIDER=twilio
TWILIO_ACCOUNT_SID=CHANGE_ME_twilio_account_sid
TWILIO_AUTH_TOKEN=CHANGE_ME_twilio_auth_token
TWILIO_PHONE_NUMBER=CHANGE_ME_twilio_from_number
TWILIO_FROM_NUMBER=CHANGE_ME_twilio_from_number
SMS_FROM_NUMBER=CHANGE_ME_sms_from_number

# Alternative SMS API
SMS_API_TOKEN=CHANGE_ME_sms_api_token
SMS_API_KEY=CHANGE_ME_sms_api_key

# =============================================================================
# PUSH NOTIFICATIONS
# =============================================================================
# Firebase Cloud Messaging
FIREBASE_SERVER_KEY=CHANGE_ME_firebase_server_key
FIREBASE_PROJECT_ID=CHANGE_ME_firebase_project_id

# Web Push (VAPID Keys)
# Generate with: npx web-push generate-vapid-keys
NEXT_PUBLIC_VAPID_PUBLIC_KEY=CHANGE_ME_vapid_public_key
VAPID_PRIVATE_KEY=CHANGE_ME_vapid_private_key

# =============================================================================
# PAYMENT GATEWAYS (Philippine Market)
# =============================================================================
# GCash
GCASH_API_KEY=CHANGE_ME_gcash_api_key
GCASH_API_SECRET=CHANGE_ME_gcash_api_secret
GCASH_MERCHANT_ID=CHANGE_ME_gcash_merchant_id
GCASH_WEBHOOK_SECRET=CHANGE_ME_gcash_webhook_secret

# PayMaya
PAYMAYA_PUBLIC_KEY=CHANGE_ME_paymaya_public_key
PAYMAYA_SECRET_KEY=CHANGE_ME_paymaya_secret_key
PAYMAYA_MERCHANT_ID=CHANGE_ME_paymaya_merchant_id
PAYMAYA_WEBHOOK_SECRET=CHANGE_ME_paymaya_webhook_secret

# =============================================================================
# REGULATORY INTEGRATIONS (Philippines)
# =============================================================================
# LTFRB (Land Transportation Franchising and Regulatory Board)
LTFRB_API_KEY=CHANGE_ME_ltfrb_api_key
LTFRB_API_SECRET=CHANGE_ME_ltfrb_api_secret
LTFRB_OPERATOR_ID=CHANGE_ME_ltfrb_operator_id

# BIR (Bureau of Internal Revenue)
BIR_API_KEY=CHANGE_ME_bir_api_key
BIR_TIN=CHANGE_ME_business_tin
BIR_BRANCH_CODE=CHANGE_ME_branch_code

# =============================================================================
# MONITORING & ALERTING
# =============================================================================
# Slack Integration
SLACK_WEBHOOK_URL=CHANGE_ME_slack_webhook_url
SLACK_DEFAULT_CHANNEL=#alerts

# PagerDuty
PAGERDUTY_SERVICE_KEY=CHANGE_ME_pagerduty_service_key

# Generic Monitoring Webhook
MONITORING_WEBHOOK_URL=CHANGE_ME_monitoring_webhook_url

# Security Alert Email
SECURITY_ALERT_EMAIL=security@opstower.com

# Emergency Contact
EMERGENCY_TEST_CONTACT=emergency@opstower.com

# =============================================================================
# FEATURE FLAGS
# =============================================================================
NEXT_PUBLIC_FEATURE_COMMAND_CENTER=true
NEXT_PUBLIC_FEATURE_GROUND_OPS=true
NEXT_PUBLIC_FEATURE_INCIDENTS=true
NEXT_PUBLIC_FEATURE_SHIFTS=true
NEXT_PUBLIC_FEATURE_BONDS=true
NEXT_PUBLIC_FEATURE_CUSTOMER_PROMOS=true
NEXT_PUBLIC_FEATURE_DASHCAM=true
NEXT_PUBLIC_FEATURE_DRIVER_INCENTIVES=true
NEXT_PUBLIC_FEATURE_TRUST_SCORE=true
NEXT_PUBLIC_FEATURE_IDENTITY_VERIFICATION=true

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================
# Location Batching
LOCATION_BATCH_SIZE=500
LOCATION_BATCH_DELAY=1000
LOCATION_BATCH_PRIORITY_DELAY=100

# Traffic Service
TRAFFIC_CACHE_SECONDS=300
TRAFFIC_BATCH_ENABLED=true
TRAFFIC_BATCH_SIZE=50

# Emergency Alerts
EMERGENCY_RESPONSE_TARGET_MS=30000
EMERGENCY_ESCALATION_ENABLED=true
EMERGENCY_AUTO_ESCALATION_INTERVALS=300000,600000,1200000

# =============================================================================
# MONITORING & LOGGING
# =============================================================================
LOG_LEVEL=info
ENABLE_REQUEST_LOGGING=true
ENABLE_PERFORMANCE_MONITORING=true
SECURITY_LOG_LEVEL=info
SECURITY_HEADERS_ENABLED=true

# Metrics
METRICS_ENABLED=true
METRICS_INTERVAL=30000
AUTO_START_METRICS=false
AUTO_START_MONITOR=false
AUTO_START_SCHEDULER=false

# Prometheus & Grafana
PROMETHEUS_ENABLED=true
GRAFANA_DASHBOARD_ENABLED=true

# =============================================================================
# REGIONAL SETTINGS
# =============================================================================
DEFAULT_REGION=metro_manila
DEFAULT_TIMEZONE=Asia/Manila
DEFAULT_COUNTRY=PH

# Map Configuration
DEFAULT_MAP_CENTER_LAT=14.5995
DEFAULT_MAP_CENTER_LNG=120.9842
DEFAULT_MAP_ZOOM=11

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
SESSION_TIMEOUT_MINUTES=480

# MFA Configuration
MFA_ENABLED=true
MFA_SECRET_KEY=CHANGE_ME_mfa_secret_key
MFA_BACKUP_CODES_COUNT=8
MFA_RATE_LIMIT_ATTEMPTS=5
MFA_RATE_LIMIT_WINDOW_MINUTES=15

# RBAC Configuration
RBAC_ENABLED=true
RBAC_APPROVAL_TTL_HOURS=4
RBAC_ENABLE_MONITORING=true
RBAC_AUDIT_ENABLED=true
RBAC_MAX_VERSIONS_PER_ROLE=25
RBAC_CACHE_TTL_MINUTES=5

# Rate Limiting
API_RATE_LIMIT_PER_MINUTE=1000

# =============================================================================
# DEVELOPMENT & TESTING
# =============================================================================
# Mock Data (for development only)
ENABLE_MOCK_DRIVERS=false
MOCK_DRIVER_COUNT=1000
MOCK_UPDATE_INTERVAL=5000

# Testing
ENABLE_TEST_EMERGENCY_ALERTS=false
TEST_EMERGENCY_INTERVAL=60000

# Deployment
DEPLOYMENT_ID=local-dev
EXPORT_MAX_ROLES_PER_REQUEST=1000

# Debug
DEBUG=false

# =============================================================================
# PRODUCTION OVERRIDES
# =============================================================================
# When NODE_ENV=production, ensure these are set:
# - All secrets are strong random values
# - DATABASE_SSL=true
# - SECURITY_HEADERS_ENABLED=true
# - MFA_ENABLED=true
# - RBAC_ENABLED=true
# - DEBUG=false
# - BYPASS_AUTH=false
# =============================================================================